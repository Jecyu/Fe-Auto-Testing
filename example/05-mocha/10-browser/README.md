# 页面测试

对于浏览器里跑的前端代码，做测试要比Node.js模块要麻烦得多。Node.js模块纯js代码，使用V8运行在本地，测试用的各种各样的依赖和工具都能快速的安装，而前端代码不仅仅要测试js，CSS等等，更麻烦的事需要模拟各种各样的浏览器，比较常见的前端代码测试方案有下面几种：

1. 构建一个测试页面，人肉直接到虚拟机上开各种浏览器跑测试页面。这个方案的缺点就是不好做代码覆盖率测试，也不好持续化集成，同时人肉工作较多

2. 使用PhantomJS构建一个伪造的浏览器环境跑单元测试，好处是解决了代码覆盖率问题，也可以做持续集成。这个方案的缺点是PhantomJS毕竟是Qt的webkit，并不是真实浏览器环境，PhantomJS也有各种各样兼容性坑

3. 通过Karma调用本机各种浏览器进行测试，好处是可以跨浏览器做测试，也可以测试覆盖率，但持续集成时需要注意只能开PhantomJS做测试，毕竟集成的Linux环境不可能有浏览器。这可以说是目前看到的最好的前端代码测试方式了.

## 步骤

1. 首先，使用mocha init命令在指定目录生成初始化文件。
```bash
mocha init test
```
2. 行上面命令，就会在 test 目录下生成index.html文件，以及配套的脚本和样式表。
3. 然后，新建一个源码文件 `index.js`。
4. 然后，把这个文件，以及断言库`chai.js`，加入`index.html`。
5. 最后，在`tests.js`里面写入测试脚本。
6. 现在，在浏览器里面打开index.html，就可以看到测试脚本的运行结果。

前端页面上测试和Node.js上测试没啥太大不同，只是需要指定Mocha使用的UI，并需要手动调用mocha.run()

，测试的结果会被显示在`<div id="mocha"></div>`这个容器里，而test/test.js里则是我们的测试的代码。